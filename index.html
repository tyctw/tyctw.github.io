<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>高雄區會考落點分析</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="google-adsense-account" content="ca-pub-3350304014189563" />
    <meta
      name="description"
      content="高雄區會考落點分析，幫助使用者分析會考成績，提供學校落點參考。"
    />
    <meta
      name="keywords"
      content="高雄區, 會考, 落點分析, 教育, 學校,國中教育會考,高雄市立高雄高級中學, 高雄市立高雄女子中學, 高雄市立左營高級中學, 高雄市立中山高級中學, 高雄市立中正高級中學, 高雄市立瑞祥高級中學, 高雄市立前鎮高級中學, 高雄市立小港高級中學, 高雄市立三民高級中學, 高雄市立鼓山高級中學, 高雄師大附中, 天主教道明中學, 高雄市立新莊高級中學, 國立岡山高中, 國立鳳山高中, 國立鳳新高中, 私立明誠高中, 私立大榮高中, 私立立志高中, 私立復華高中, 國立中山大學附屬國光高中, 國立旗美高中, 市立新興高中, 市立楠梓高中, 市立福誠高中, 市立林園高中, 市立六龜高中, 市立路竹高中, 市立仁武高中, 市立文山高中, 私立正義高中, 財團法人普門中學, 財團法人新光高中, 私立義大國際高中, 國立高師大附中 國立中山大學附屬國光高中"
    />
    <meta name="author" content="高雄區教育局" />
    <!-- External JS Libraries -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.3.1/dist/jsQR.min.js"></script>
  </head>
  <body>
    <header class="header">
      <div class="header-container">
        <div class="header-logo">
          <i class="fas fa-chart-line"></i>
          <span>高雄區會考落點分析</span>
        </div>
        <div class="menu-icon" onclick="toggleMenu()">
          <i class="fas fa-bars"></i>
        </div>
      </div>
    </header>

    <div class="fullscreen-menu" id="fullscreenMenu">
      <div class="close-menu" onclick="toggleMenu()">
        <i class="fas fa-times"></i>
      </div>
      <div class="menu-items">
        <a href="https://sites.google.com/view/khtw/" target="_blank">
          <i class="fas fa-school"></i> 回到主網頁
        </a>
        <a href="https://tyctw.github.io/report_form" target="_blank">
          <i class="fas fa-pencil-alt"></i> 系統異常回報
        </a>
        <a href="https://tyctw.github.io/search/" target="_blank">
          <i class="fas fa-exclamation-triangle"></i> 系統異常查詢
        </a>
        <a href="https://khhtw.github.io/Navigation/">
          <i class="fas fa-university"></i> 查看更多資訊
        </a>
      </div>
    </div>

    <div class="container">
      <div class="decoration-element top-left"></div>
      <div class="decoration-element bottom-right"></div>
      
      <h1>
        <i class="fas fa-chart-line icon"></i>高雄區會考落點分析系統
      </h1>
      <div class="action-buttons">
        <a
          href="https://forms.gle/FRhzNFxGMs9qQYtV7"
          target="_blank"
          class="invite-link"
        >
          <i class="fas fa-envelope-open-text icon"></i>填寫表單獲取邀請碼
        </a>
        <button class="instruction-toggle" onclick="toggleInstructions()">
          <i class="fas fa-info-circle icon"></i>使用說明
        </button>
        <button class="disclaimer-toggle" onclick="showDisclaimer()">
          <i class="fas fa-exclamation-triangle icon"></i>免責聲明
        </button>
      </div>
      
      <div id="instructions" style="display: none;">
        <h2>
          <i class="fas fa-book icon"></i>使用說明
        </h2>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-key icon"></i>1. 獲取並輸入邀請碼
          </h3>
          <p>
            每小時更新一次邀請碼。您可以通過以下方式獲取：
          </p>
          <ul>
            <li>填寫我們的序位回報表單</li>
            <li>掃描官方提供的 QR 碼</li>
          </ul>
          <p>
            <span style="color: var(--primary-color); font-weight: bold;">重要提醒：</span>邀請碼有效期為一小時，請確保使用最新的邀請碼。
          </p>
          <div style="text-align: center; margin: 15px 0;">
            <a
              href="https://forms.gle/FRhzNFxGMs9qQYtV7"
              target="_blank"
              class="invite-link"
              style="display: inline-block; width: auto;"
            >
              <i class="fas fa-envelope-open-text icon"></i>立即獲取邀請碼
            </a>
          </div>
        </div>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-filter icon"></i>2. 選擇學校篩選條件
          </h3>
          <p>
            根據您的需求和偏好設置 flavorful篩選條件：
          </p>
          <ul>
            <li><strong>學校屬性</strong>：選擇全部、公立或私立學校</li>
            <li><strong>學校類型</strong>：選擇全部、普通科或職業類科</li>
            <li><strong>職業群別</strong>：如選擇職業類科，可進一步選擇特定職業群或全部群別</li>
          </ul>
          <p>
            適當的篩選可以幫助您更精準地找到符合需求的學校。
          </p>
        </div>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-pencil-alt icon"></i>3. 輸入會考成績
          </h3>
          <p>
            請為每個科目選擇您的會考等級：
          </p>
          <ul>
            <li><strong>國文、英文、數學、自然、社會</strong>：從 A++ 到 C 共七個等級</li>
            <li><strong>作文</strong>：從 0 到 6 級分</li>
          </ul>
          <p>
            <span style="color: #e74c3c; font-weight: bold;">注意事項：</span>
            所有科目都必須填寫，否則系統將無法進行分析。請確保您輸入的成績準確無誤。
          </p>
        </div>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-search icon"></i>4. 分析落點並查看顧ult
          </h3>
          <p>
            點擊「分析落點」按鈕後，系統將：
          </p>
          <ul>
            <li>驗證您的邀請碼有效性</li>
            <li>計算您的總積分和總積點</li>
            <li>分析您在各校的錄取可能性</li>
            <li>根據篩選條件列出可能錄取的學校</li>
          </ul>
          <p>
            分析結果將顯示：
          </p>
          <ul>
            <li>您的總積分和總積點數據</li>
            <li>按學校類型分類的可能錄取學校列表</li>
            <li>分析時使用的詳細資料（成績、篩選條件等）</li>
          </ul>
        </div>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-file-export icon"></i>5. 匯出或列印結果
          </h3>
          <p>
            您可以將分析結果保存為多種格式：
          </p>
          <ul>
            <li><strong>TXT 格式</strong>：純文字檔案，適合於基本記錄</li>
            <li><strong>CSV 格式</strong>：可用Excel或其他表格軟體打開</li>
            <li><strong>JSON 格式</strong>：適合數據處理或進一步分析</li>
            <li><strong>HTML 格式</strong>：可在瀏覽器中查看的網頁格式</li>
            <li><strong>列印功能</strong>：直接列印分析結果或保存為PDF</li>
          </ul>
          <p>
            匯出功能位於分析結果下方，點擊「匯出結果」按鈕即可使用。
          </p>
        </div>
        <div class="instruction-item">
          <h3>
            <i class="fas fa-redo icon"></i>6. 重新分析和進階使用
          </h3>
          <p>
            您可以隨時調整以下內容並重新分析：
          </p>
          <ul>
            <li>修改會考成績以模擬不同成績組合</li>
            <li>調整學校篩選條件以探索更多可能性</li>
            <li>比較不同成績組合下的錄取學校變化</li>
          </ul>
          <p>
            <span style="color: var(--primary-color); font-weight: bold;">小技巧：</span>
            您可以嘗試不同的成績組合，了解提升特定科目可能帶來的影響，幫助制定更有效的學習策略。
          </p>
        </div>
      </div>

      <form id="analysisForm">
        <div class="form-group">
          <label for="invitationCode">
            <i class="fas fa-key icon"></i>邀請碼：
          </label>
          <input
            type="text"
            id="invitationCode"
            required
            placeholder="請輸入邀請碼"
          />
        </div>

        <div class="qr-options">
          <button type="button" id="scanQRCode">
            <i class="fas fa-camera icon"></i>掃描 QR 碼
          </button>
          <label for="fileInput" class="file-input-label">
            <i class="fas fa-image icon"></i>上傳 QR 碼
          </label>
          <input type="file" id="fileInput" accept="image/*" />
        </div>
      </form>
      <div id="qr-reader" style="display: none;"></div>
      <div id="qr-result"></div>

      <div class="form-group">
        <label for="userIdentity">
          <i class="fas fa-user-tag icon"></i>您的身份：
        </label>
        <select id="userIdentity">
          <option value="student">學生</option>
          <option value="parent">家長</option>
          <option value="teacher">教師</option>
        </select>
      </div>
      <div class="form-group">
        <label for="schoolOwnership">
          <i class="fas fa-building icon"></i>學校屬性：
        </label>
        <select id="schoolOwnership">
          <option value="all">全部</option>
          <option value="public">公立</option>
          <option value="private">私立</option>
        </select>
      </div>
      <div class="form-group">
        <label for="schoolType">
          <i class="fas fa-graduation-cap icon"></i>學校類型：
        </label>
        <select id="schoolType" onchange="toggleVocationalGroup()">
          <option value="all">全部</option>
          <option value="普通科">普通科</option>
          <option value="職業類科">職業類科</option>
        </select>
      </div>
      <div
        class="form-group"
        id="vocationalGroupContainer"
        style="display: none;"
      >
        <label for="vocationalGroup">
          <i class="fas fa-tools icon"></i>職業群別：
        </label>
        <select id="vocationalGroup">
          <option value="all">全部</option>
          <option value="機械群">機械群</option>
          <option value="動力機械群">動力機械群</option>
          <option value="電機與電子群">電機與電子群</option>
          <option value="化工群">化工群</option>
          <option value="土木與建築群">土木與建築群</option>
          <option value="商業與管理群">商業與管理群</option>
          <option value="外語群">外語群</option>
          <option value="設計群">設計群</option>
          <option value="農業群">農業群</option>
          <option value="食品群">食品群</option>
          <option value="家政群">家政群</option>
          <option value="餐旅群">餐旅群</option>
        </select>
      </div>
      <div class="form-group">
        <label for="chinese">
          <i class="fas fa-book icon"></i>國文：
        </label>
        <select id="chinese">
          <option value="">請選擇您的國文會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group">
        <label for="english">
          <i class="fas fa-language icon"></i>英文：
        </label>
        <select id="english">
          <option value="">請選擇您的英文會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group">
        <label for="math">
          <i class="fas fa-calculator icon"></i>數學：
        </label>
        <select id="math">
          <option value="">請選擇您的數學會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group">
        <label for="science">
          <i class="fas fa-flask icon"></i>自然：
        </label>
        <select id="science">
          <option value="">請選擇您的自然會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group">
        <label for="social">
          <i class="fas fa-globe icon"></i>社會：
        </label>
        <select id="social">
          <option value="">請選擇您的社會會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group">
        <label for="composition">
          <i class="fas fa-pen-nib icon"></i>作文：
        </label>
        <select id="composition">
          <option value="">請選擇您的作文會考分數</option>
          <option value="0">0 級分</option>
          <option value="1">1 級分</option>
          <option value="2">2 級分</option>
          <option value="3">3 級分</option>
          <option value="4">4 級分</option>
          <option value="5">5 級分</option>
          <option value="6">6 級分</option>
        </select>
      </div>
      <button type="button" id="analyzeButton" onclick="analyzeScores()">
        <i class="fas fa-search icon"></i>分析落點
      </button>
      <button id="exportResults" style="display: none;" onclick="exportResults()">
        <i class="fas fa-file-export icon"></i>匯出結果
      </button>
      <div id="results"></div>

      <!-- New User Rating Section -->
      <div id="ratingSection">
        <h2><i class="fas fa-star icon"></i> 為KHTW網站評分</h2>
        <div id="starsContainer">
          <span class="star" data-value="1">&#9733;</span>
          <span class="star" data-value="2">&#9733;</span>
          <span class="star" data-value="3">&#9733;</span>
          <span class="star" data-value="4">&#9733;</span>
          <span class="star" data-value="5">&#9733;</span>
        </div>
        <button id="submitRating">
          <i class="fas fa-paper-plane icon"></i> 提交評分
        </button>
        <div id="ratingMessage"></div>
      </div>

      <div class="copyright">
        &copy; <span id="currentYear"></span> KHTW高雄區會考落點分析系統. All rights reserved.
        <p>本網站由KHTW會考落點分析平台開發維護。未經授權，禁止複製或轉載。</p>
      </div>
    </div>

    <button id="darkModeToggle" class="dark-mode-toggle" aria-label="切換深色模式">
      <i class="fas fa-moon"></i>
    </button>

    <!-- 美化版免責聲明 Modal -->
    <div id="disclaimerModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeDisclaimer()">&times;</span>
        <div class="disclaimer-header">
          <i class="fas fa-balance-scale"></i>
          <h2>免責聲明</h2>
        </div>
        <div class="disclaimer-banner">
          <a href="https://forms.gle/FRhzNFxGMs9qQYtV7" target="_blank">
            <i class="fas fa-link"></i> 填寫表單獲取邀請碼
          </a>
        </div>
        <div class="disclaimer-body">
          <div class="disclaimer-section">
            <div class="section-icon"><i class="fas fa-info-circle"></i></div>
            <div class="section-content">
              <p>親愛的使用者，我們誠摯地提醒您：本網站提供的落點分析結果僅供參考，不代表實際錄取結果。實際錄取情況可能會因多種因素而有所不同，包括但不限於：</p>
            </div>
          </div>
          <ul class="disclaimer-list">
            <li><i class="fas fa-university"></i> 各校的招生政策變化</li>
            <li><i class="fas fa-users"></i> 當年度考生整體表現</li>
            <li><i class="fas fa-star"></i> 特殊才能或其他加分項目</li>
            <li><i class="fas fa-clipboard-list"></i> 各校的實際招生名額調整</li>
          </ul>
          <div class="disclaimer-section warning">
            <div class="section-icon"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="section-content">
              <p>為了確保您做出最佳的決定，我們強烈建議您：</p>
            </div>
          </div>
          <ul class="disclaimer-list">
            <li><i class="fas fa-search"></i> 參考多方資訊，不要僅依賴本網站的分析結果</li>
            <li><i class="fas fa-comments"></i> 諮詢學校輔導老師或升學顧問的專業意見</li>
            <li><i class="fas fa-globe"></i> 密切關注各校的官方網站和招生簡章，以獲取最新和最準確的資訊</li>
          </ul>
          <div class="disclaimer-section important">
            <div class="section-icon"><i class="fas fa-shield-alt"></i></div>
            <div class="section-content">
              <p>本網站不對因使用本服務而產生的任何直接或間接損失負責。使用本服務即表示您同意本免責聲明的所有條款。祝您升學順利！</p>
            </div>
          </div>
        </div>
        <button class="confirm-button" onclick="closeDisclaimer()">
          <i class="fas fa-check-circle"></i> 我已了解並同意
        </button>
      </div>
    </div>

    <style>
      .header {
        background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        color: white;
        padding: 18px 0;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
      }
      
      .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }
      
      .header-logo {
        font-size: 1.5em;
        font-weight: bold;
        display: flex;
        align-items: center;
      }
      
      .header-logo i {
        margin-right: 12px;
        font-size: 1.2em;
      }

      .menu-icon {
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: background-color 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .menu-icon:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }

      .menu-icon i {
        font-size: 1.5em;
      }
      
      .fullscreen-menu {
        position: fixed;
        top: 0;
        right: 0;
        width: 320px;
        height: 100%;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-left: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: -5px 0 30px rgba(0, 0, 0, 0.15);
        z-index: 2000;
        transform: translateX(100%);
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease;
        opacity: 0;
        display: flex;
        flex-direction: column;
      }
      
      .fullscreen-menu.show {
        transform: translateX(0);
        opacity: 1;
      }
      
      .close-menu {
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 1.8em;
        color: var(--text-color);
        cursor: pointer;
        transition: all 0.3s ease;
        height: 40px;
        width: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(0,0,0,0.05);
        border: 2px solid transparent;
      }
      
      .close-menu:hover {
        transform: rotate(90deg);
        color: var(--primary-color);
        background: rgba(67, 97, 238, 0.1);
        border-color: var(--primary-color);
      }
      
      .menu-items {
        display: flex;
        flex-direction: column;
        padding: 80px 15px 30px;
        height: 100%;
        overflow-y: auto;
      }
      
      .fullscreen-menu a {
        color: var(--text-color);
        text-decoration: none;
        font-size: 1.1em;
        margin: 8px 0;
        padding: 16px 20px;
        border-radius: 16px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(0, 0, 0, 0.05);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      
      .fullscreen-menu a i {
        margin-right: 15px;
        font-size: 1.3em;
        width: 24px;
        text-align: center;
        color: var(--primary-color);
        transition: transform 0.3s ease;
      }
      
      .fullscreen-menu a:hover {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        transform: translateX(5px) scale(1.02);
        border-color: transparent;
      }

      .fullscreen-menu a:hover i {
        color: white;
        transform: scale(1.2);
      }
      
      /* Dark mode adjustments */
      body.dark-mode .fullscreen-menu {
        background: rgba(25, 25, 25, 0.98);
      }
      
      body.dark-mode .close-menu {
        background: rgba(255,255,255,0.05);
      }
      
      body.dark-mode .close-menu:hover {
        background: rgba(67, 97, 238, 0.2);
      }
      
      body.dark-mode .fullscreen-menu a {
        background: rgba(40, 40, 40, 0.8);
        border-color: rgba(255, 255, 255, 0.05);
      }

      body.dark-mode .fullscreen-menu a:hover {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border-color: transparent;
      }

      @media (max-width: 768px) {
        .fullscreen-menu {
          width: 100%;
        }

        .menu-items {
          padding: 80px 20px 30px;
        }

        .fullscreen-menu a {
          margin: 10px 0;
          padding: 18px 24px;
        }
      }

      .decoration-element {
        position: absolute;
        z-index: -1;
        opacity: 0.4;
      }
      
      .top-left {
        top: 0;
        left: 0;
        width: 150px;
        height: 150px;
        background: linear-gradient(135deg, var(--primary-color) 0%, transparent 70%);
        border-radius: 0 0 150px 0;
      }
      
      .bottom-right {
        bottom: 0;
        right: 0;
        width: 150px;
        height: 150px;
        background: linear-gradient(315deg, var(--accent-color) 0%, transparent 70%);
        border-radius: 150px 0 0 0;
      }
    </style>

    <script src="script.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H9X7EC127P"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-H9X7EC127P');
    </script>
  </body>
</html>
