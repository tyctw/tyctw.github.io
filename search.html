<html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>查詢系統異常回報紀錄</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: #f4f4f4;
  }
  h1 {
    color: #2c3e50;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
  }
  form {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    margin-bottom: 5px;
  }
  input[type="text"] {
    width: 100%;
    padding: 8px;
    margin-bottom: 20px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  button {
    background-color: #3498db;
    color: #fff;
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover {
    background-color: #2980b9;
  }
  #result {
    margin-top: 20px;
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
</style>
</head>
<body>
  <h1>查詢系統異常回報紀錄</h1>
  
  <form id="queryForm">
    <label for="reportCode">回報代碼：</label>
    <input type="text" id="reportCode" name="reportCode" required>
    <button type="submit">查詢</button>
  </form>

  <div id="result"></div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyhElcY1tQUGKOtvE041Rhur-XZHUuNvNVyd1X18P94ZWGKZFRAcZqlA1wiEa5JRvvb/exec';

    document.getElementById('queryForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const reportCode = document.getElementById('reportCode').value;
      queryReport(reportCode);
    });

    function queryReport(reportCode) {
      fetch(`${SCRIPT_URL}?reportCode=${reportCode}`)
        .then(response => response.json())
        .then(data => {
          const resultDiv = document.getElementById('result');
          if (data.found) {
            resultDiv.innerHTML = `
              <h2>回報紀錄</h2>
              <p><strong>時間戳記：</strong> ${data.timestamp}</p>
              <p><strong>回報者電子郵件：</strong> ${data.email}</p>
              <p><strong>問題類別：</strong> ${data.category}</p>
              <p><strong>問題描述：</strong> ${data.description}</p>
              <p><strong>回報代碼：</strong> ${data.reportCode}</p>
            `;
          } else {
            resultDiv.innerHTML = '<p>找不到相關回報紀錄。請確認回報代碼是否正確。</p>';
          }
        })
        .catch(error => {
          console.error('Error:', error);
          document.getElementById('result').innerHTML = '<p>查詢時發生錯誤。請稍後再試。</p>';
        });
    }
  </script>
</body>
</html>
